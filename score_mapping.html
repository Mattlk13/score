<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><link href="css/default.css" rel="stylesheet" type="text/css" /><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>Score Mapping </title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Score</span> <span class="project-version">0.4.0-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="basics.html"><div class="inner"><span>Basics of Score Writing Using Lists </span></div></a></li><li class="depth-1 "><a href="csound.html"><div class="inner"><span>Csound Live Coding Example </span></div></a></li><li class="depth-1 "><a href="design.html"><div class="inner"><span>Design</span></div></a></li><li class="depth-1 "><a href="euclid.html"><div class="inner"><span>Euclidean Rhythms</span></div></a></li><li class="depth-1 "><a href="intro.html"><div class="inner"><span>Introduction to Score</span></div></a></li><li class="depth-1 "><a href="lc.html"><div class="inner"><span>lc! - mini-language for notation</span></div></a></li><li class="depth-1 "><a href="mask.html"><div class="inner"><span>Mask</span></div></a></li><li class="depth-1 "><a href="musical_values.html"><div class="inner"><span>Musical Values</span></div></a></li><li class="depth-1 "><a href="score_gen.html"><div class="inner"><span>Score Generation</span></div></a></li><li class="depth-1  current"><a href="score_mapping.html"><div class="inner"><span>Score Mapping </span></div></a></li><li class="depth-1 "><a href="score_organization.html"><div class="inner"><span>Score Organization </span></div></a></li><li class="depth-1 "><a href="sieves.html"><div class="inner"><span>Sieves</span></div></a></li><li class="depth-1 "><a href="transformation.html"><div class="inner"><span>Score Transformation </span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>score</span></div></div></li><li class="depth-2 branch"><a href="score.amp.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>amp</span></div></a></li><li class="depth-2 branch"><a href="score.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="score.euclid.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>euclid</span></div></a></li><li class="depth-2 branch"><a href="score.freq.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>freq</span></div></a></li><li class="depth-2 branch"><a href="score.lc.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>lc</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>mask</span></div></div></li><li class="depth-3 branch"><a href="score.mask.accumulator.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>accumulator</span></div></a></li><li class="depth-3 branch"><a href="score.mask.bpf.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>bpf</span></div></a></li><li class="depth-3 branch"><a href="score.mask.generators.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>generators</span></div></a></li><li class="depth-3 branch"><a href="score.mask.items.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>items</span></div></a></li><li class="depth-3 branch"><a href="score.mask.mask.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>mask</span></div></a></li><li class="depth-3 branch"><a href="score.mask.oscillators.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>oscillators</span></div></a></li><li class="depth-3 branch"><a href="score.mask.probability.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>probability</span></div></a></li><li class="depth-3"><a href="score.mask.quantizer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>quantizer</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -269px;"><span class="top" style="height: 278px;"></span><span class="bottom"></span></span><span>orchestra</span></div></div></li><li class="depth-3 branch"><a href="score.orchestra.performer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>performer</span></div></a></li><li class="depth-3"><a href="score.orchestra.performer-group.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>performer-group</span></div></a></li><li class="depth-2 branch"><a href="score.sieves.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>sieves</span></div></a></li><li class="depth-2 branch"><a href="score.tuning.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tuning</span></div></a></li><li class="depth-2"><a href="score.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li></ul></div><div class="document" id="content"><div class="doc"><div class="markdown"><h1><a href="#score-mapping" name="score-mapping"></a>Score Mapping</h1>
<p>Like Common Music and SmOKe, Score’s internal design is backend agnostic. This means that the representation of data is not tied to a single target music system. Users can use mapping functions to convert note lists generated by Score into a format that works with another system. This may be for use with other computer music systems but may also be used for visualisation or other purposes.</p>
<p>The following shows an example use of Score and Csound. It uses the <code>gen-notes2</code> function to generate a note list from time 0 to 5.0 using 5 fields. The first field is a constant field that will always generate 1. The rest of the p-fields of the Csound score is generated using the values provided by within the <code>score.mask</code> package.</p>
<pre><code class="clojure">(def notes
  (gen-notes2 0 5.0
              1
              (gauss 0.5 0.1)
              (heap [0.1 0.2 0.4])
              (rand-range 0.1 0.25)
              (rand-item
                ["8.00" "8.03" "8.02"])))
(def csound-sco
  (format-sco notes))

(println notes)
(println csound-sco)
</code></pre>
<p>The results of printing the output are shown below:</p>
<pre><code class="clojure">;; output from (println notes)
[[1 0.0 0.1 0.1455446063675899 8.02]
 [1 0.07388877495229043 0.2 0.11487888605849467 8.00]
 [1 0.2684591839186033 0.4 0.12170487899979296 8.00]
 [1 1.0558572506209922 0.4 0.13304255988624555 8.03]
 [1 1.554791683668857 0.2 0.16436113185377213 8.00]
 [1 1.9392915161730429 0.1 0.11907587313489418 8.02]
 [1 2.3410899943560195 0.2 0.21996317376289015 8.03]
 [1 2.787924993057282 0.4 0.2119026696996974 8.00]
 [1 3.7580 770774079575 0.1 0.12327608647786711 8.00]
 [1 4.199933807980773 0.2 0.23620482696864334 8.00]]

;; output from (println csound-sco)
i1 0.0 0.1 0.1455446063675899 8.02
i1 0.07388877495229043 0.2 0.11487888605849467 8.00
i1 0.2684591839186033 0.4 0.12170487899979296 8.00
i1 1.0558572506209922 0.4 0.13304255988624555 8.03
i1 1.554791683668857 0.2 0.16436113185377213 8.00
i1 1.9392915161730429 0.1 0.11907587313489418 8.02
i1 2.3410899943560195 0.2 0.21996317376289015 8.03
i1 2.787924993057282 0.4 0.2119026696996974 8.00
i1 3.7580770774079575 0.1 0.12327608647786711 8.00
i1 4.199933807980773 0.2 0.23620482696864334 8.00
</code></pre>
<p>The first printout shows the results of running <code>gen-notes2</code>, which produces a Clojure list of lists. The second printout shows the result of using the <code>format-sco</code> function, provided by Score for formatting note lists into Csound SCO text format. The <code>csound-sco</code> text may then be further sent to a running Csound instance for live score performance or written to disk and later read by Csound as a SCO file.</p>
<p>At this time, Score only provides output mapping for Csound. However, Score’s generated note lists are usable as-is with Pink, as both systems are written in Clojure. In <a href="https://github.com/kunstmusik/music-examples/blob/master/src/music_examples/track1.clj">track1.clj</a>, <code>growing-line</code> defines a note list using both features from Score and Pink. The code first uses two note lists generated using the <code>gen-notes</code> function that are concatenated together. This is then mapped over and the <code>growl</code> audio function is prepended as the first field of each note in the note list. The <code>e</code> argument given to <code>gen-notes</code> is itself a Pink audio function – the <code>env</code> function – that is wrapped using the <code>!*!</code> operator. The result is that for each note, the 6th field will be an instance of <code>env</code> used as the amplitude argument to the <code>growl</code> instrument.</p>
<pre><code class="clojure">;; from music-examples.track1 example file
(def growing-line
  (let [e (!*! env [0.0 400 0.11 5000])
        starts (range 0 1.8 (/ 1.0 3.0))
        amps (range 0.05 5 0.05)
        space (range 0.75 -1.0 -0.25)]
    (map #(into [growl] %)
         (concat
           (gen-notes starts 0.1 :G5 amps e 0.75 space)
           (gen-notes starts 0.1 :G3 amps e 0.75 space)
           ))))
</code></pre>
<p>From here, the <code>growing-line</code> note list is then reused as a part of a larger measured-score. <code>convert-measured-score</code> is used to prodcue to the total score, which is then mapped into Pink events using the <code>sco-&amp;gt;events</code> function provided in the <code>pink.simple</code> namespace.</p>
<pre><code>(defn apply-afunc-with-dur
  "Applies an afunc to given args within the context of a
  given duration. with-duration will bind the value of dur
  to the *duration* Pink context variable."
  [afunc dur &amp; args]
  (with-duration (double dur)
    (apply!*! afunc args)))

(defn i
  "Csound style note events: audio-func, start, dur, &amp; args."
  [afunc start dur &amp; args]
  (apply event apply-afunc-with-dur start afunc dur args))

(defn sco-&gt;events
  "Converts Csound-style note list into a list of
  Pink Events."
  [notes]
  (map #(apply i %) notes))
</code></pre>
<p>The above shows the code for <code>sco-&amp;gt;events</code>. Given a list of notes, <code>sco-&amp;gt;event</code> maps an anonymous function that applies the <code>i</code> function to the values found in each note. The <code>i</code> function in turn applies the <code>event</code> function to each note, using <code>apply-afunc-with-dur</code> as the event’s function – the one that will fired by Pink’s event processor – with the given arguments. Finally, when <code>apply-afunc-with-dur</code> is called, it fires by processing the values found in the original note, applying the first field – the audio function – to the rest of the fields.</p>
<p>In the full track1.clj example, these Pink events are further passed to the <code>add-audio-events</code> function from <code>pink.simple</code>. This is a convenience function that wraps events with another event that uses the <code>add-afunc</code> function to attach audio functions to the root node of the engine. At runtime, when an event is fired, the nested event will generate an audio function and the top-level event will add it to the engine for processing.</p>
<p>The mapping of note lists is the technique by which the generated data from Score is connected to other systems. Score currently provides a mapping function for Csound and works out of the box with Pink, as shown in the example code. In the future, more mappings could be provided with Score, such as MIDI, OSC, and MusicXML. As the data generated from Score is plain Clojure list data, users can create their own mappings relatively simply.</p></div></div></div></body></html>