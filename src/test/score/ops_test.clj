(ns score.ops-test
  (:require [clojure.test :refer :all]
            [score.ops :refer :all]
            ))

(deftest sco-dur-test
  (is (= 10.0 (sco-dur [[0 4 5] [0 9 1]])))
  (is (= 10.0 (sco-dur [[0 9 1] [0 4 5]])))
  (is (= 8.0 (sco-dur [[0 5.5 2.5]])))
  (is (= 0.0 (sco-dur [])))
  (is (= 0.0 (sco-dur nil))))

(deftest |+|-test
  (is (= [[0 2.0 1] [0 3.0 1]]
         (|+| [[0 0 1] [0 1 1]] 2)))
  (is (= [[0 5.0 1] [0 3.0 1]]
         (|+| [[0 3 1] [0 1 1]] 2))))

(deftest |*|-test
  (is (= [[0 0.0 1] [0 1.0 1] [0 2.0 1] [0 3.0 1]]
         (|*| [[0 0 1] [0 1 1]] 2 2) ))
  (is (= [[0 3.0 1] [0 4.0 1] [0 5.0 1] [0 6.0 1]]
         (|*| [[0 0 1] [0 1 1]] 2 2 3.0))))

(deftest |s|-test
  (is (= [[0 0.0 1] [0 1.0 1] [0 2.0 2] [0 3.0 2]]
      (|s| [[0 0 1] [0 1 1]] 
            [[0 0 2] [0 1 2]]
            )))

  (is (= [[0 0.0 1] [0 1.0 1] [0 4.0 2] [0 5.0 2]]
      (|s| [[0 0 1] [0 1 1]]
            2.0
            [[0 0 2] [0 1 2]]
            ))))

(deftest |p|-test
  (is (= [[0 0 1] [0 1 1] [0 0 2] [0 1 2]]
      (|p| [[0 0 1] [0 1 1]] 
            [[0 0 2] [0 1 2]]
            ))))

(deftest |scale|-test
  (is (= [[0 0.0 1.5] [0 1.5 1.5]]
      (|scale| [[0 0 1] [0 1 1]] 1.5)))

  (is (= [[0 3.0 3.0] [0 6.0 3.0]]
      (|scale| [[0 1 1] [0 2 1]] 3))))

(deftest |scale-to|-test
  (is (= [[0 0.0 1.5] [0 1.5 1.5]]
      (|scale-to| [[0 0 1] [0 1 1]] 3.0)))

  (is (= [[0 3.0 3.0] [0 6.0 3.0]]
      (|scale-to| [[0 1 1] [0 2 1]] 9))))
